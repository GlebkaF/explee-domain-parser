# Domain CSV Parser

**Proof of Concept** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ CSV —Å –¥–æ–º–µ–Ω–∞–º–∏ –∫–æ–º–ø–∞–Ω–∏–π.  
–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –∑–∞–≥—Ä—É–∑–∫–∞ CSV ‚Üí –ø–∞—Ä—Å–∏–Ω–≥ –¥–æ–º–µ–Ω–æ–≤ ‚Üí —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö ‚Üí LLM-–∞–Ω–∞–ª–∏–∑ ‚Üí –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

---

## üéØ –ó–∞–¥–∞—á–∞

> **Section 2: Build a prototype for domain CSV processing**
>
> - –ó–∞–≥—Ä—É–∑–∫–∞ CSV —Ñ–∞–π–ª–∞ —Å –¥–æ–º–µ–Ω–∞–º–∏ –∫–æ–º–ø–∞–Ω–∏–π
> - –ó–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞–∂–¥–æ–≥–æ –¥–æ–º–µ–Ω–∞ (–ø–æ–ª—É—á–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏)
> - –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ –±–æ–ª—å—à–æ–º—É —Å–ø–∏—Å–∫—É –¥–æ–º–µ–Ω–æ–≤
> - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (—Å—Ç–∞—Ç—É—Å—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏) –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü
> - –ü—Ä–æ—Ç–æ—Ç–∏–ø –¥–æ–ª–∂–µ–Ω –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, –Ω–µ –æ–±—è–∑–∞–Ω –±—ã—Ç—å production-ready

---


## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Proof of Concept

### 1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ LLM-–æ–±—Ä–∞–±–æ—Ç–∫–∏**

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –ü–æ–ª—É—á–µ–Ω–∏–µ HTML –∏ LLM-–∞–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤ –æ–¥–Ω–æ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ.

**Production –ø–æ–¥—Ö–æ–¥:**
```
–®–∞–≥ 1: –ê–≥–µ–Ω—Ç —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
  Domain (created) ‚Üí fetch HTML ‚Üí save rawHtmlData ‚Üí status: html_fetched

–®–∞–≥ 2: –ê–≥–µ–Ω—Ç LLM-–æ–±—Ä–∞–±–æ—Ç–∫–∏  
  Domain (html_fetched) ‚Üí send to LLM ‚Üí save description ‚Üí status: completed
```

**–ü–æ—á–µ–º—É —Ä–∞–∑–¥–µ–ª–∏—Ç—å:**
- –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –±—ã—Å—Ç—Ä–µ–µ)
- –ü–µ—Ä–µ–æ–±—Ä–∞–±–æ—Ç–∫–∞ LLM –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ fetch HTML
- –†–∞–∑–Ω—ã–µ rate limits –∏ retry policy –¥–ª—è HTTP –∏ LLM API

**–ü–æ—á–µ–º—É —Å—Ö–ª–æ–ø–Ω—É—Ç–æ –≤ POC:**
- –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ cron-—Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ
- –ù–µ—Å–∫–æ–ª—å–∫–æ cron-–∑–∞–¥–∞—á —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —Ä–∏—Å–∫ –ø—Ä–æ–ø—É—Å–∫–∞/–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –£–ø—Ä–æ—â–µ–Ω–∏–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

### 2. **–§–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**  Cron –Ω–∞ Vercel —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑  api endpoint + –∫–æ–Ω—Ñ–∏–≥ –≤ vercel.json, –Ω–æ –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º —Ç–∞—Ä–∏—Ñ–µ cron –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –¥–µ–Ω—å (–∞ –Ω–∞–º –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –≤ —Ä–µ–∞–ª—Ç–∞–π–º–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥—å), –ø–æ—ç—Ç–æ–º—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø—Ä—è–º–æ –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∞–ø–∏, –Ω–æ –∏ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤ Vercel, –ø–æ—ç—Ç–æ–º—É —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ñ–æ–ª–±–µ–∫ —á–µ—Ä–µ–∑ UI –∫–Ω–æ–ø–∫—É "–ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—á–µ—Ä–µ–¥–∏", –∫–æ—Ç–æ—Ä–∞—è —Ç–æ–∂–µ –¥–µ—Ä–≥–∞–µ—Ç `/api/cron/process-domains`.

**Production –ø–æ–¥—Ö–æ–¥:**

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–π –∫—Ä–æ–Ω –∏–ª–∏ –æ—á–µ—Ä–µ–¥—å 


**–ü–æ—á–µ–º—É –ø—Ä—è–º–æ–π API –≤—ã–∑–æ–≤ –≤ POC:**
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
- –ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Ñ–∏–¥–±–µ–∫ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö cron-—Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è –¥–µ–º–æ


### 3. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è **–æ–¥–∏–Ω –¥–æ–º–µ–Ω –∑–∞ —Ä–∞–∑**.

```typescript
// –ë–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –¥–æ–º–µ–Ω
const queuedDomain = await prisma.domain.findFirst({
  where: { status: 'queued' }
});
```

**Production –ø–æ–¥—Ö–æ–¥:**

```typescript
// –ë–µ—Ä–µ–º –ø–∞—á–∫—É –¥–æ–º–µ–Ω–æ–≤
const queuedDomains = await prisma.domain.findMany({
  where: { status: 'queued' },
  take: 10 // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º 10 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
});

// –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
await Promise.allSettled(
  queuedDomains.map(domain => processDomain(domain.id))
);
```

**–ò–ª–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–æ—Ä–∫–µ—Ä–æ–≤:**
```
3-5 –≤–æ—Ä–∫–µ—Ä–æ–≤ ‚Üí –∫–∞–∂–¥—ã–π –±–µ—Ä–µ—Ç –ø–æ –æ–¥–Ω–æ–º—É –¥–æ–º–µ–Ω—É –∏–∑ –æ—á–µ—Ä–µ–¥–∏
‚Üí –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
‚Üí –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –±–µ—Ä—É—Ç —Å–ª–µ–¥—É—é—â–∏–π
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ë—ã—Å—Ç—Ä–µ–µ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–æ–º–µ–Ω–æ–≤
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- –ö–æ–Ω—Ç—Ä–æ–ª—å concurrency (–Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∑–∏—Ç—å API)

**–ü–æ—á–µ–º—É –æ–¥–∏–Ω –¥–æ–º–µ–Ω –≤ POC:**
- –õ–∏–º–∏—Ç—ã –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –ë–î –∏ Vercel –≤ —Ü–µ–ª–æ–º 
- –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã pipeline


---


## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞


### –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–º–µ–Ω–∞

```
User –∫–ª–∏–∫ "Run Agent"
    ‚Üì
Status: created ‚Üí queued
    ‚Üì
/api/cron/process-domains (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –ø–æ cron)
    ‚Üì
Status: queued ‚Üí running
    ‚Üì
1. Fetch HTML from domain
    ‚Üì
2. Clean HTML (remove scripts/styles/tags)
    ‚Üì
3. Send to LLM (GPT-4o-mini)
    ‚Üì
4. Get company description
    ‚Üì
Status: running ‚Üí completed
    ‚Üì
Description –¥–æ—Å—Ç—É–ø–Ω–æ –≤ UI
```

## üöÄ –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env`:

```env
DATABASE_URL="postgresql://user:password@host/database"
OPENAI_API_KEY="sk-..."
```

### 3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
npx prisma migrate dev
```

### 4. –ó–∞–ø—É—Å–∫ dev —Å–µ—Ä–≤–µ—Ä–∞

```bash
npm run dev
```

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000



## üìù –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

–ü—Ä–∏–º–µ—Ä CSV —Ñ–∞–π–ª–∞:

```csv
domain
google.com
github.com
openai.com
vercel.com
https://www.reddit.com/r/programming
http://example.com:8080/path?query=1
```

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è –¥–æ:
```
google.com
github.com
openai.com
vercel.com
reddit.com
example.com
```
